
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>bimpy.bSlabList &#8212; bImPy 0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for bimpy.bSlabList</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statistics</span> <span class="c1"># to get median value from a list of numbers</span>
<span class="kn">from</span> <span class="nn">xml.dom</span> <span class="k">import</span> <span class="n">minidom</span> <span class="c1"># to load vesselucida xml file</span>

<div class="viewcode-block" id="bSlabList"><a class="viewcode-back" href="../../bimpy.html#bimpy.bSlabList.bSlabList">[docs]</a><span class="k">class</span> <span class="nc">bSlabList</span><span class="p">:</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	full list of all points in a vascular tracing</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tifPath</span><span class="p">):</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">tifPath</span> <span class="o">=</span> <span class="n">tifPath</span>

		<span class="c1"># nodes</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nodex</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nodey</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nodez</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">noded</span> <span class="o">=</span> <span class="p">[]</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">edgeDictList</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># this should be .annotationList</span>

		<span class="c1"># slab/edges</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># to count edges</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="p">[]</span>

		<span class="c1"># for nathan convex hull</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">orig_x</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">orig_y</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">orig_z</span> <span class="o">=</span> <span class="p">[]</span>

		<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">		self.d = []</span>
<span class="sd">		self.edgeIdx = []</span>
<span class="sd">		&#39;&#39;&#39;</span>

		<span class="c1"># todo: change this to _slabs.txt</span>
		<span class="n">slabFilePath</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">tifPath</span><span class="p">)</span>
		<span class="n">slabFilePath</span> <span class="o">+=</span> <span class="s1">&#39;_slabs.txt&#39;</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">slabFilePath</span><span class="p">):</span>
			<span class="c1">#print(&#39;bSlabList warning, did not find slabFilePath:&#39;, slabFilePath)</span>
			<span class="c1">#return</span>
			<span class="k">pass</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">pointFilePath</span><span class="p">)</span>

			<span class="n">nSlabs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
			<span class="c1">#self.id = np.full(nSlabs, np.nan) #df.iloc[:,0].values # each point/slab will have an edge id</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">nSlabs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">#Return a new array of given shape and type, filled with fill_value.</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tracing z max:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">loadVesselucida_xml</span><span class="p">()</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">numNodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="p">)</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">numSlabs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">numEdges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edgeDictList</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_massage_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
		<span class="n">xUmPerPixel</span> <span class="o">=</span> <span class="mf">0.49718</span>
		<span class="n">yUmPerPixel</span> <span class="o">=</span> <span class="mf">0.49718</span>
		<span class="n">zUmPerSlice</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="c1"># Olympus .txt is telling us 0.4 ???</span>
		<span class="n">zOffset</span> <span class="o">=</span> <span class="mi">0</span>

		<span class="c1"># flip y</span>
		<span class="n">y</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
		<span class="c1"># offset z</span>
		<span class="n">z</span> <span class="o">+=</span> <span class="n">zOffset</span>
		<span class="c1"># flip x/y</span>
		<span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
			<span class="n">tmp</span> <span class="o">=</span> <span class="n">y</span>
			<span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
			<span class="n">x</span> <span class="o">=</span> <span class="n">tmp</span>
		<span class="c1"># convert um to pixel using um/pixel = 0.497 and 0.4 um/slice</span>
		<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">xUmPerPixel</span>
		<span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">yUmPerPixel</span>
		<span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="n">zUmPerSlice</span>

		<span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span>

<div class="viewcode-block" id="bSlabList.loadVesselucida_xml"><a class="viewcode-back" href="../../bimpy.html#bimpy.bSlabList.bSlabList.loadVesselucida_xml">[docs]</a>	<span class="k">def</span> <span class="nf">loadVesselucida_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Load a vesselucida xml file with nodes, edges, and edge connectivity</span>
<span class="sd">		&quot;&quot;&quot;</span>

		<span class="n">xmlFilePath</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tifPath</span><span class="p">)</span>
		<span class="n">xmlFilePath</span> <span class="o">+=</span> <span class="s1">&#39;.xml&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">xmlFilePath</span><span class="p">):</span>
			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bSlabList.loadVesselucida_xml() error, did not find&#39;</span><span class="p">,</span> <span class="n">xmlFilePath</span><span class="p">)</span>
			<span class="k">return</span>

		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;loadVesselucida_xml() file&#39;</span><span class="p">,</span> <span class="n">xmlFilePath</span><span class="p">)</span>
		<span class="n">mydoc</span> <span class="o">=</span> <span class="n">minidom</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">xmlFilePath</span><span class="p">)</span>

		<span class="n">vessels</span> <span class="o">=</span> <span class="n">mydoc</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;vessel&#39;</span><span class="p">)</span>
		<span class="c1">#print(&#39;found&#39;, len(vessels), &#39;vessels&#39;)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">orig_x</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">orig_y</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">orig_z</span> <span class="o">=</span> <span class="p">[]</span>

		<span class="n">masterNodeIdx</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">masterEdgeIdx</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">masterSlabIdx</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vessel</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vessels</span><span class="p">):</span>
			<span class="c1">#print(&#39;vessel i:&#39;, i, &#39;name:&#39;, vessel.attributes[&#39;name&#39;].value)</span>

			<span class="c1">#</span>
			<span class="c1"># nodes</span>
			<span class="n">startNodeIdx</span> <span class="o">=</span> <span class="n">masterNodeIdx</span>
			<span class="n">nodes</span> <span class="o">=</span> <span class="n">vessel</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;nodes&#39;</span><span class="p">)</span>
			<span class="c1">#print(&#39;   has&#39;, len(nodes), &#39;nodes&#39;)</span>
			<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
				<span class="n">nodeList</span> <span class="o">=</span> <span class="n">vessel</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">)</span>
				<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodeList</span><span class="p">)):</span>
					<span class="n">node_id</span> <span class="o">=</span> <span class="n">nodeList</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
					<span class="n">point</span> <span class="o">=</span> <span class="n">nodeList</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;point&#39;</span><span class="p">)</span> <span class="c1"># node is only one 3d point</span>
					<span class="k">for</span> <span class="n">point0</span> <span class="ow">in</span> <span class="n">point</span><span class="p">:</span>
						<span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">point0</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
						<span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">point0</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
						<span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">point0</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
						<span class="n">diam</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">point0</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

						<span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massage_xyz</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>

						<span class="bp">self</span><span class="o">.</span><span class="n">nodex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">nodey</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">nodez</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">noded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diam</span><span class="p">)</span>

						<span class="c1"># todo: somehow assign edge list</span>
						<span class="c1"># important so user can scroll through all nodes and</span>
						<span class="c1"># check they have &gt;1 edge !!!</span>
						<span class="n">nodeDict</span> <span class="o">=</span> <span class="p">{</span>
							<span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
							<span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
							<span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">z</span><span class="p">,</span>
							<span class="s1">&#39;zSlice&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="c1">#todo remember this when I convert to um/pixel !!!</span>
							<span class="s1">&#39;edgeList&#39;</span><span class="p">:[],</span>
							<span class="s1">&#39;nEdges&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
						<span class="p">}</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nodeDict</span><span class="p">)</span>

					<span class="n">masterNodeIdx</span> <span class="o">+=</span> <span class="mi">1</span>

			<span class="c1">#</span>
			<span class="c1"># edges</span>
			<span class="n">startEdgeIdx</span> <span class="o">=</span> <span class="n">masterEdgeIdx</span>
			<span class="n">edges</span> <span class="o">=</span> <span class="n">vessel</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;edges&#39;</span><span class="p">)</span>
			<span class="c1">#print(&#39;   found&#39;, len(edges), &#39;edges&#39;)</span>
			<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">edge</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">edges</span><span class="p">):</span>
				<span class="n">edgeList</span> <span class="o">=</span> <span class="n">vessel</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;edge&#39;</span><span class="p">)</span>
				<span class="c1">#print(&#39;      found&#39;, len(edgeList), &#39;edges&#39;)</span>
				<span class="c1"># one edge (vessel segment between 2 branch points)</span>
				<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">edgeList</span><span class="p">)):</span>
					<span class="n">edge_id</span> <span class="o">=</span> <span class="n">edgeList</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
					<span class="n">points</span> <span class="o">=</span> <span class="n">edgeList</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;point&#39;</span><span class="p">)</span> <span class="c1"># edge is a list of 3d points</span>
					<span class="c1"># this is my &#39;edge&#39; list, the tubes between branch points ???</span>
					<span class="c1">#print(&#39;         for edge id&#39;, edge_id, &#39;found&#39;, len(points), &#39;points&#39;)</span>
					<span class="c1"># list of points for one edge</span>
					<span class="n">thisSlabList</span> <span class="o">=</span> <span class="p">[]</span>
					<span class="n">newZList</span> <span class="o">=</span> <span class="p">[]</span>
					<span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
						<span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
						<span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
						<span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
						<span class="n">diam</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

						<span class="bp">self</span><span class="o">.</span><span class="n">orig_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">orig_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">orig_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

						<span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massage_xyz</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>

						<span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

						<span class="n">newZList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
						<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">						self.d.append(diam)</span>
<span class="sd">						self.edgeIdx.append(masterEdgeIdx)</span>
<span class="sd">						&#39;&#39;&#39;</span>
						<span class="n">thisSlabList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">masterSlabIdx</span><span class="p">)</span>
						<span class="n">masterSlabIdx</span> <span class="o">+=</span> <span class="mi">1</span>

					<span class="n">edgeDict</span> <span class="o">=</span> <span class="p">{</span>
						<span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;edge&#39;</span><span class="p">,</span>
						<span class="s1">&#39;edgeIdx&#39;</span><span class="p">:</span> <span class="n">masterEdgeIdx</span><span class="p">,</span>
						<span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">newZList</span><span class="p">),</span>
						<span class="s1">&#39;Len 3D&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
						<span class="s1">&#39;Len 2D&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
						<span class="s1">&#39;Tort&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
						<span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">statistics</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">newZList</span><span class="p">)),</span>
						<span class="s1">&#39;preNode&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
						<span class="s1">&#39;postNode&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
						<span class="s1">&#39;Bad&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
						<span class="s1">&#39;slabList&#39;</span><span class="p">:</span> <span class="n">thisSlabList</span><span class="p">,</span> <span class="c1"># list of slab indices on this edge</span>
						<span class="p">}</span>

					<span class="bp">self</span><span class="o">.</span><span class="n">edgeDictList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edgeDict</span><span class="p">)</span>

					<span class="c1"># add nan</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
					<span class="n">masterSlabIdx</span> <span class="o">+=</span> <span class="mi">1</span>
					<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">					self.d.append(np.nan)</span>
<span class="sd">					self.edgeIdx.append(np.nan)</span>
<span class="sd">					&#39;&#39;&#39;</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">orig_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">orig_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">orig_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
					<span class="n">masterEdgeIdx</span> <span class="o">+=</span> <span class="mi">1</span>

			<span class="c1">#</span>
			<span class="c1"># edgelists</span>
			<span class="n">edgeListList</span> <span class="o">=</span> <span class="n">vessel</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;edgelist&#39;</span><span class="p">)</span>
			<span class="c1">#print(&#39;   found&#39;, len(edgeListList), &#39;edgelists&#39;)</span>
			<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">edgeList</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">edgeListList</span><span class="p">):</span>
				<span class="c1"># src/dst node are 0 based for given vessel</span>
				<span class="nb">id</span> <span class="o">=</span> <span class="n">edgeList</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="c1"># gives us the edge list index in self.x</span>
				<span class="n">srcNode</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">edgeList</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;sourcenode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
				<span class="n">dstNode</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">edgeList</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;targetnode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
				<span class="c1">#print(&#39;   srcNode:&#39;, srcNode, &#39;dstNode:&#39;, dstNode)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">edgeDictList</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;preNode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">srcNode</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">edgeDictList</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;postNode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dstNode</span>
				<span class="k">if</span> <span class="n">srcNode</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
					<span class="c1">#print(&#39;adding srcNode startNodeIdx:&#39;, startNodeIdx, &#39;srcNode:&#39;, srcNode, &#39;startEdgeIdx:&#39;, startEdgeIdx)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="p">[</span><span class="n">startNodeIdx</span><span class="o">+</span><span class="n">srcNode</span><span class="p">][</span><span class="s1">&#39;edgeList&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">startEdgeIdx</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="p">[</span><span class="n">startNodeIdx</span><span class="o">+</span><span class="n">srcNode</span><span class="p">][</span><span class="s1">&#39;nEdges&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="p">[</span><span class="n">startNodeIdx</span><span class="o">+</span><span class="n">srcNode</span><span class="p">][</span><span class="s1">&#39;edgeList&#39;</span><span class="p">])</span>
					<span class="c1">#print(&#39;   edgeList:&#39;, self.nodeDictList[startNodeIdx+srcNode][&#39;edgeList&#39;])</span>
					<span class="c1">#print(&#39;   nEdges:&#39;, self.nodeDictList[startNodeIdx+srcNode][&#39;nEdges&#39;])</span>
				<span class="k">if</span> <span class="n">dstNode</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
					<span class="c1">#print(&#39;adding dstNode startNodeIdx:&#39;, startNodeIdx, &#39;dstNode:&#39;, dstNode, &#39;startEdgeIdx:&#39;, startEdgeIdx)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="p">[</span><span class="n">startNodeIdx</span><span class="o">+</span><span class="n">dstNode</span><span class="p">][</span><span class="s1">&#39;edgeList&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">startEdgeIdx</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="p">[</span><span class="n">startNodeIdx</span><span class="o">+</span><span class="n">dstNode</span><span class="p">][</span><span class="s1">&#39;nEdges&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="p">[</span><span class="n">startNodeIdx</span><span class="o">+</span><span class="n">dstNode</span><span class="p">][</span><span class="s1">&#39;edgeList&#39;</span><span class="p">])</span>
					<span class="c1">#print(&#39;   edgeList:&#39;, self.nodeDictList[startNodeIdx+dstNode][&#39;edgeList&#39;])</span>
					<span class="c1">#print(&#39;   nEdges:&#39;, self.nodeDictList[startNodeIdx+dstNode][&#39;nEdges&#39;])</span>
		<span class="c1"># end</span>
		<span class="c1"># for i, vessel in enumerate(vessels):</span>

		<span class="n">nPoints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">nPoints</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">#Return a new array of given shape and type, filled with fill_value.</span>

		<span class="c1">#</span>
		<span class="c1"># convert to numpy array</span>
		<span class="c1"># nodes</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nodex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodex</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nodey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodey</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nodez</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodez</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
		<span class="c1"># edges</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

		<span class="c1"># debug min/max of x/y/z</span>
		<span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x min/max&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;y min/max&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;z min/max&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   loaded&#39;</span><span class="p">,</span> <span class="n">masterNodeIdx</span><span class="p">,</span> <span class="s1">&#39;nodes,&#39;</span><span class="p">,</span> <span class="n">masterEdgeIdx</span><span class="p">,</span> <span class="s1">&#39;edges, and approximately&#39;</span><span class="p">,</span> <span class="n">masterSlabIdx</span><span class="p">,</span> <span class="s1">&#39;points&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="bSlabList.save"><a class="viewcode-back" href="../../bimpy.html#bimpy.bSlabList.bSlabList.save">[docs]</a>	<span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Save _ann.txt file from self.annotationList</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bSlabList.save() not implemented&#39;</span><span class="p">)</span></div>

		<span class="c1"># headers are keys of xxxx</span>

		<span class="c1"># each element in xxx is a comma seperated row</span>

<div class="viewcode-block" id="bSlabList.load"><a class="viewcode-back" href="../../bimpy.html#bimpy.bSlabList.bSlabList.load">[docs]</a>	<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Load _ann.txt file</span>
<span class="sd">		Store in self.annotationList</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bSlabList.load()&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="bSlabList.toggleBadEdge"><a class="viewcode-back" href="../../bimpy.html#bimpy.bSlabList.bSlabList.toggleBadEdge">[docs]</a>	<span class="k">def</span> <span class="nf">toggleBadEdge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edgeIdx</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bSlabList.toggleBadEdge() edgeIdx:&#39;</span><span class="p">,</span> <span class="n">edgeIdx</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">edgeDictList</span><span class="p">[</span><span class="n">edgeIdx</span><span class="p">][</span><span class="s1">&#39;Good&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">edgeDictList</span><span class="p">[</span><span class="n">edgeIdx</span><span class="p">][</span><span class="s1">&#39;Good&#39;</span><span class="p">]</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   edge&#39;</span><span class="p">,</span> <span class="n">edgeIdx</span><span class="p">,</span> <span class="s1">&#39;is now&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edgeDictList</span><span class="p">[</span><span class="n">edgeIdx</span><span class="p">][</span><span class="s1">&#39;Good&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="bSlabList.getNode_zSlice"><a class="viewcode-back" href="../../bimpy.html#bimpy.bSlabList.bSlabList.getNode_zSlice">[docs]</a>	<span class="k">def</span> <span class="nf">getNode_zSlice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodeIdx</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Return z image slice of a node units are slices</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="p">[</span><span class="n">nodeIdx</span><span class="p">][</span><span class="s1">&#39;zSlice&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="bSlabList.getNode_xyz"><a class="viewcode-back" href="../../bimpy.html#bimpy.bSlabList.bSlabList.getNode_xyz">[docs]</a>	<span class="k">def</span> <span class="nf">getNode_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodeIdx</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Return (x,y,z) of a node units are um/pixel</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="p">[</span><span class="n">nodeIdx</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
		<span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="p">[</span><span class="n">nodeIdx</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
		<span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodeDictList</span><span class="p">[</span><span class="n">nodeIdx</span><span class="p">][</span><span class="s1">&#39;z&#39;</span><span class="p">]</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></div>

<div class="viewcode-block" id="bSlabList.getEdge"><a class="viewcode-back" href="../../bimpy.html#bimpy.bSlabList.bSlabList.getEdge">[docs]</a>	<span class="k">def</span> <span class="nf">getEdge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edgeIdx</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		return a list of slabs in an edge</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">theseIndices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">edgeIdx</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">theseIndices</span></div>

<div class="viewcode-block" id="bSlabList.analyze"><a class="viewcode-back" href="../../bimpy.html#bimpy.bSlabList.bSlabList.analyze">[docs]</a>	<span class="k">def</span> <span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Fill in derived values in self.edgeDictList</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">def</span> <span class="nf">euclideanDistance</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">z1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">z2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">z2</span><span class="o">-</span><span class="n">z1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

		<span class="n">edgeIdx</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numSlabs</span>
		<span class="n">len2d</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">len3d</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">len3d_nathan</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">pointIdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
			<span class="c1"># todo get rid of this</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="n">pointIdx</span><span class="p">]</span> <span class="o">=</span> <span class="n">edgeIdx</span>

			<span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">pointIdx</span><span class="p">]</span>
			<span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">pointIdx</span><span class="p">]</span>
			<span class="n">z1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">pointIdx</span><span class="p">]</span>

			<span class="c1">#print(&#39;pointIdx:&#39;, pointIdx)</span>
			<span class="n">orig_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_x</span><span class="p">[</span><span class="n">pointIdx</span><span class="p">]</span>
			<span class="n">orig_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_y</span><span class="p">[</span><span class="n">pointIdx</span><span class="p">]</span>
			<span class="n">orig_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_z</span><span class="p">[</span><span class="n">pointIdx</span><span class="p">]</span>

			<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">z1</span><span class="p">):</span>
				<span class="c1"># move on to a new edge/vessel</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">edgeDictList</span><span class="p">[</span><span class="n">edgeIdx</span><span class="p">][</span><span class="s1">&#39;Len 2D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">len2d</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">edgeDictList</span><span class="p">[</span><span class="n">edgeIdx</span><span class="p">][</span><span class="s1">&#39;Len 3D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">len3d</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">edgeDictList</span><span class="p">[</span><span class="n">edgeIdx</span><span class="p">][</span><span class="s1">&#39;Len 3D Nathan&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">len3d_nathan</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
				<span class="n">len2d</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="n">len3d</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="n">len3d_nathan</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="n">orig_x</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="n">edgeIdx</span> <span class="o">+=</span> <span class="mi">1</span>
				<span class="k">continue</span>

			<span class="k">if</span> <span class="n">pointIdx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">len3d</span> <span class="o">=</span> <span class="n">len3d</span> <span class="o">+</span> <span class="n">euclideanDistance</span><span class="p">(</span><span class="n">prev_x1</span><span class="p">,</span> <span class="n">prev_y1</span><span class="p">,</span> <span class="n">prev_z1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">)</span>
				<span class="n">len2d</span> <span class="o">=</span> <span class="n">len2d</span> <span class="o">+</span> <span class="n">euclideanDistance</span><span class="p">(</span><span class="n">prev_x1</span><span class="p">,</span> <span class="n">prev_y1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
				<span class="n">len3d_nathan</span> <span class="o">=</span> <span class="n">len3d_nathan</span> <span class="o">+</span> <span class="n">euclideanDistance</span><span class="p">(</span><span class="n">prev_orig_x1</span><span class="p">,</span> <span class="n">prev_orig_y1</span><span class="p">,</span> <span class="n">prev_orig_z1</span><span class="p">,</span> <span class="n">orig_x</span><span class="p">,</span> <span class="n">orig_y</span><span class="p">,</span> <span class="n">orig_z</span><span class="p">)</span>
			<span class="n">prev_x1</span> <span class="o">=</span> <span class="n">x1</span>
			<span class="n">prev_y1</span> <span class="o">=</span> <span class="n">y1</span>
			<span class="n">prev_z1</span> <span class="o">=</span> <span class="n">z1</span>

			<span class="n">prev_orig_x1</span> <span class="o">=</span> <span class="n">orig_x</span>
			<span class="n">prev_orig_y1</span> <span class="o">=</span> <span class="n">orig_y</span>
			<span class="n">prev_orig_z1</span> <span class="o">=</span> <span class="n">orig_z</span></div></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
	<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/Users/cudmore/box/data/nathan/vesselucida/20191017__0001.tif&#39;</span>
	<span class="n">sl</span> <span class="o">=</span> <span class="n">bSlabList</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">bImPy</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Robert H Cudmore.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>